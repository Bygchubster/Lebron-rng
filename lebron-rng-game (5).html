<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeBron RNG: King's Gacha</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes roll-spin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(1080deg); }
        }
        .rolling {
            animation: roll-spin 2s ease-out;
        }
        @keyframes glow-pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        .glow-animate {
            animation: glow-pulse 2s ease-in-out infinite;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 min-h-screen text-white">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef, useMemo } = React;

        // Types
        const Rarity = {
            COMMON: 'Common',
            UNCOMMON: 'Uncommon',
            RARE: 'Rare',
            EPIC: 'Epic',
            LEGENDARY: 'Legendary',
            MYTHIC: 'Mythic',
            CELESTIAL: 'Celestial',
            DIVINE: 'Divine',
            GOAT: 'GOAT'
        };

        // Constants
        const RARITY_CONFIG = {
            [Rarity.COMMON]: { color: 'text-gray-400', glow: 'shadow-gray-500/50', bg: 'bg-gray-800' },
            [Rarity.UNCOMMON]: { color: 'text-green-400', glow: 'shadow-green-500/50', bg: 'bg-green-900/40' },
            [Rarity.RARE]: { color: 'text-blue-400', glow: 'shadow-blue-500/50', bg: 'bg-blue-900/40' },
            [Rarity.EPIC]: { color: 'text-purple-400', glow: 'shadow-purple-500/50', bg: 'bg-purple-900/40' },
            [Rarity.LEGENDARY]: { color: 'text-yellow-400', glow: 'shadow-yellow-500/50', bg: 'bg-yellow-900/40' },
            [Rarity.MYTHIC]: { color: 'text-red-500', glow: 'shadow-red-500/50', bg: 'bg-red-900/40' },
            [Rarity.CELESTIAL]: { color: 'text-cyan-400', glow: 'shadow-cyan-500/50', bg: 'bg-cyan-900/40' },
            [Rarity.DIVINE]: { color: 'text-pink-400', glow: 'shadow-pink-500/50', bg: 'bg-pink-900/40' },
            [Rarity.GOAT]: { color: 'text-white font-bold tracking-widest', glow: 'shadow-white/80', bg: 'bg-gradient-to-r from-orange-500 via-white to-orange-500' },
        };

        const LEBRON_IMAGE = 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/LeBron_James_crop.jpg/800px-LeBron_James_crop.jpg';

        const PLAYERS = [
            { id: 'lb1', name: 'Baby LeBron', rarity: Rarity.COMMON, odds: 2, color: 'text-gray-400', glowColor: 'gray', image: LEBRON_IMAGE, luckBonus: 0, coinsBonus: 5 },
            { id: 'lb2', name: 'Draft Day LeBron', rarity: Rarity.COMMON, odds: 5, color: 'text-gray-400', glowColor: 'gray', image: LEBRON_IMAGE, luckBonus: 0.1, coinsBonus: 10 },
            { id: 'lb3', name: 'High School LeBron', rarity: Rarity.UNCOMMON, odds: 15, color: 'text-green-400', glowColor: 'green', image: LEBRON_IMAGE, luckBonus: 0.2, coinsBonus: 25 },
            { id: 'lb4', name: 'Masked LeBron', rarity: Rarity.UNCOMMON, odds: 25, color: 'text-green-400', glowColor: 'green', image: LEBRON_IMAGE, luckBonus: 0.5, coinsBonus: 50 },
            { id: 'lb5', name: 'Taco Tuesday LeBron', rarity: Rarity.RARE, odds: 50, color: 'text-blue-400', glowColor: 'blue', image: LEBRON_IMAGE, luckBonus: 1, coinsBonus: 100 },
            { id: 'lb6', name: 'Headband LeBron', rarity: Rarity.RARE, odds: 100, color: 'text-blue-400', glowColor: 'blue', image: LEBRON_IMAGE, luckBonus: 2, coinsBonus: 250 },
            { id: 'lb7', name: 'Miami Heat LeBron', rarity: Rarity.EPIC, odds: 250, color: 'text-purple-400', glowColor: 'purple', image: LEBRON_IMAGE, luckBonus: 5, coinsBonus: 500 },
            { id: 'lb8', name: 'Space Jam LeBron', rarity: Rarity.EPIC, odds: 500, color: 'text-purple-400', glowColor: 'purple', image: LEBRON_IMAGE, luckBonus: 10, coinsBonus: 1000 },
            { id: 'lb9', name: 'The Silencer LeBron', rarity: Rarity.LEGENDARY, odds: 1000, color: 'text-yellow-400', glowColor: 'yellow', image: LEBRON_IMAGE, luckBonus: 25, coinsBonus: 2500 },
            { id: 'lb10', name: 'King James', rarity: Rarity.LEGENDARY, odds: 2500, color: 'text-yellow-400', glowColor: 'yellow', image: LEBRON_IMAGE, luckBonus: 50, coinsBonus: 5000 },
            { id: 'lb11', name: 'LePookie Bear', rarity: Rarity.LEGENDARY, odds: 5000, color: 'text-yellow-400', glowColor: 'yellow', image: LEBRON_IMAGE, luckBonus: 100, coinsBonus: 10000 },
            { id: 'lb12', name: 'Skibidi LeBron', rarity: Rarity.MYTHIC, odds: 10000, color: 'text-red-500', glowColor: 'red', image: LEBRON_IMAGE, luckBonus: 250, coinsBonus: 25000 },
            { id: 'lb13', name: 'You Are My Sunshine LeBron', rarity: Rarity.MYTHIC, odds: 25000, color: 'text-red-500', glowColor: 'red', image: LEBRON_IMAGE, luckBonus: 500, coinsBonus: 50000 },
            { id: 'lb14', name: 'Mewing LeBron', rarity: Rarity.MYTHIC, odds: 50000, color: 'text-red-500', glowColor: 'red', image: LEBRON_IMAGE, luckBonus: 1000, coinsBonus: 100000 },
            { id: 'lb15', name: 'Cybernetic LeBron 3000', rarity: Rarity.CELESTIAL, odds: 100000, color: 'text-cyan-400', glowColor: 'cyan', image: LEBRON_IMAGE, luckBonus: 2500, coinsBonus: 250000 },
            { id: 'lb16', name: 'The Chosen One (Ascended)', rarity: Rarity.DIVINE, odds: 500000, color: 'text-pink-400', glowColor: 'pink', image: LEBRON_IMAGE, luckBonus: 10000, coinsBonus: 1000000 },
            { id: 'lb17', name: 'Gold LeBron (Statue)', rarity: Rarity.GOAT, odds: 1000000, color: 'text-white', glowColor: 'white', image: LEBRON_IMAGE, luckBonus: 25000, coinsBonus: 5000000 },
            { id: 'lb18', name: 'Literal Goat LeBron', rarity: Rarity.GOAT, odds: 5000000, color: 'text-white', glowColor: 'white', image: LEBRON_IMAGE, luckBonus: 100000, coinsBonus: 25000000 },
            { id: 'lb19', name: 'Universe 23 LeBron', rarity: Rarity.GOAT, odds: 10000000, color: 'text-white', glowColor: 'white', image: LEBRON_IMAGE, luckBonus: 500000, coinsBonus: 100000000 },
        ];

        const POTIONS = [
            { id: 'p1', name: 'Minor Luck Potion', type: 'luck', multiplier: 2, duration: 60000, price: 1000, color: 'from-green-400 to-green-600' },
            { id: 'p2', name: 'Major Luck Potion', type: 'luck', multiplier: 5, duration: 300000, price: 10000, color: 'from-blue-400 to-blue-600' },
            { id: 'p3', name: 'Hyper Luck Potion', type: 'luck', multiplier: 20, duration: 600000, price: 100000, color: 'from-purple-400 to-purple-600' },
            { id: 'p4', name: 'Cash Infusion', type: 'money', multiplier: 5, duration: 120000, price: 5000, color: 'from-yellow-400 to-yellow-600' },
        ];

        const LUCK_UPGRADE_COSTS = [
            100, 500, 2500, 15000, 100000, 750000, 5000000, 50000000, 1000000000
        ];

        const LUCK_PER_LEVEL = 1.0;

        // Components
        const RollDisplay = ({ lastRoll, isRolling }) => {
            if (!lastRoll && !isRolling) return null;

            return (
                <div className="mb-8">
                    <div className={`relative ${isRolling ? 'rolling' : 'fade-in'}`}>
                        <div className={`p-8 rounded-2xl ${RARITY_CONFIG[lastRoll?.rarity]?.bg || 'bg-gray-800'} border-2 ${RARITY_CONFIG[lastRoll?.rarity]?.color || 'border-gray-600'} shadow-2xl ${RARITY_CONFIG[lastRoll?.rarity]?.glow || ''}`}>
                            {isRolling ? (
                                <div className="text-center">
                                    <div className="text-4xl mb-4">üé≤</div>
                                    <div className="text-2xl font-bold">Rolling...</div>
                                </div>
                            ) : lastRoll && (
                                <div className="text-center">
                                    <img src={lastRoll.image} alt={lastRoll.name} className="w-48 h-48 mx-auto mb-4 rounded-xl object-cover border-4 border-white/20" />
                                    <div className={`text-3xl font-bold mb-2 ${lastRoll.color}`}>{lastRoll.name}</div>
                                    <div className={`text-xl mb-4 ${RARITY_CONFIG[lastRoll.rarity].color}`}>{lastRoll.rarity}</div>
                                    <div className="text-sm text-gray-300">
                                        <div>Luck Bonus: +{lastRoll.luckBonus}</div>
                                        <div>Coins Bonus: +{lastRoll.coinsBonus}</div>
                                        <div className="mt-2 text-xs text-gray-400">1 in {lastRoll.odds.toLocaleString()} odds</div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const EquippedDisplay = ({ equipped }) => {
            if (equipped.length === 0) return null;

            return (
                <div className="mb-6 slide-up">
                    <h3 className="text-xl font-bold mb-3 text-center">üèÄ Equipped Team</h3>
                    <div className="grid grid-cols-2 md:grid-cols-5 gap-2">
                        {equipped.map((player, idx) => (
                            <div key={idx} className={`p-3 rounded-lg ${RARITY_CONFIG[player.rarity].bg} border ${RARITY_CONFIG[player.rarity].color} text-center`}>
                                <img src={player.image} alt={player.name} className="w-16 h-16 mx-auto mb-2 rounded-lg object-cover" />
                                <div className="text-xs font-semibold truncate">{player.name}</div>
                                <div className="text-xs text-gray-400">+{player.luckBonus} luck</div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const InventoryModal = ({ stats, setStats, showInventory, setShowInventory }) => {
            if (!showInventory) return null;

            const handleEquip = (player) => {
                if (stats.equipped.some(p => p.id === player.id)) {
                    setStats(prev => ({
                        ...prev,
                        equipped: prev.equipped.filter(p => p.id !== player.id)
                    }));
                } else if (stats.equipped.length < 5) {
                    setStats(prev => ({
                        ...prev,
                        equipped: [...prev.equipped, player]
                    }));
                }
            };

            const sortedInventory = [...stats.inventory].sort((a, b) => b.odds - a.odds);

            return (
                <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onClick={() => setShowInventory(false)}>
                    <div className="bg-gray-900 rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto border-2 border-purple-500" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-3xl font-bold">üì¶ Inventory</h2>
                            <button onClick={() => setShowInventory(false)} className="text-4xl hover:text-red-500 transition">&times;</button>
                        </div>
                        
                        {stats.inventory.length === 0 ? (
                            <div className="text-center text-gray-400 py-12">No LeBrons collected yet. Start rolling!</div>
                        ) : (
                            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                {sortedInventory.map((player, idx) => {
                                    const isEquipped = stats.equipped.some(p => p.id === player.id);
                                    return (
                                        <div key={idx} className={`p-4 rounded-xl ${RARITY_CONFIG[player.rarity].bg} border-2 ${isEquipped ? 'border-green-400' : RARITY_CONFIG[player.rarity].color}`}>
                                            <img src={player.image} alt={player.name} className="w-full h-32 object-cover rounded-lg mb-3" />
                                            <div className={`font-bold text-sm mb-1 ${player.color}`}>{player.name}</div>
                                            <div className={`text-xs mb-2 ${RARITY_CONFIG[player.rarity].color}`}>{player.rarity}</div>
                                            <div className="text-xs text-gray-300 mb-3">
                                                <div>Luck: +{player.luckBonus}</div>
                                                <div>Coins: +{player.coinsBonus}</div>
                                            </div>
                                            <button
                                                onClick={() => handleEquip(player)}
                                                disabled={!isEquipped && stats.equipped.length >= 5}
                                                className={`w-full py-2 rounded-lg text-xs font-bold transition ${
                                                    isEquipped 
                                                        ? 'bg-red-500 hover:bg-red-600' 
                                                        : stats.equipped.length >= 5
                                                        ? 'bg-gray-600 cursor-not-allowed'
                                                        : 'bg-green-500 hover:bg-green-600'
                                                }`}
                                            >
                                                {isEquipped ? 'Unequip' : stats.equipped.length >= 5 ? 'Team Full' : 'Equip'}
                                            </button>
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const ShopModal = ({ stats, setStats, showShop, setShowShop }) => {
            if (!showShop) return null;

            const handleBuyPotion = (potion) => {
                if (stats.coins < potion.price) return;

                setStats(prev => ({
                    ...prev,
                    coins: prev.coins - potion.price,
                    activePotions: {
                        ...prev.activePotions,
                        [potion.type]: Date.now() + potion.duration
                    }
                }));
            };

            const handleUpgradeLuck = () => {
                const cost = LUCK_UPGRADE_COSTS[stats.luckUpgrades];
                if (stats.coins >= cost && stats.luckUpgrades < LUCK_UPGRADE_COSTS.length) {
                    setStats(prev => ({
                        ...prev,
                        coins: prev.coins - cost,
                        luckUpgrades: prev.luckUpgrades + 1,
                        luckMultiplier: prev.luckMultiplier + LUCK_PER_LEVEL
                    }));
                }
            };

            return (
                <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onClick={() => setShowShop(false)}>
                    <div className="bg-gray-900 rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto border-2 border-yellow-500" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-3xl font-bold">üõí Shop</h2>
                            <button onClick={() => setShowShop(false)} className="text-4xl hover:text-red-500 transition">&times;</button>
                        </div>

                        <div className="mb-8">
                            <h3 className="text-2xl font-bold mb-4">‚≠ê Luck Mastery</h3>
                            <div className="bg-gray-800 p-6 rounded-xl border-2 border-purple-500">
                                <div className="text-xl mb-2">Current Level: {stats.luckUpgrades}</div>
                                <div className="text-lg mb-4">Total Luck Multiplier: {stats.luckMultiplier.toFixed(1)}x</div>
                                {stats.luckUpgrades < LUCK_UPGRADE_COSTS.length ? (
                                    <>
                                        <div className="text-sm text-gray-400 mb-4">
                                            Next upgrade: +{LUCK_PER_LEVEL} luck (Level {stats.luckUpgrades + 1})
                                        </div>
                                        <button
                                            onClick={handleUpgradeLuck}
                                            disabled={stats.coins < LUCK_UPGRADE_COSTS[stats.luckUpgrades]}
                                            className={`w-full py-3 rounded-lg font-bold transition ${
                                                stats.coins >= LUCK_UPGRADE_COSTS[stats.luckUpgrades]
                                                    ? 'bg-purple-600 hover:bg-purple-700'
                                                    : 'bg-gray-600 cursor-not-allowed'
                                            }`}
                                        >
                                            Upgrade for üí∞ {LUCK_UPGRADE_COSTS[stats.luckUpgrades].toLocaleString()}
                                        </button>
                                    </>
                                ) : (
                                    <div className="text-center text-green-400 font-bold">MAX LEVEL REACHED!</div>
                                )}
                            </div>
                        </div>

                        <div>
                            <h3 className="text-2xl font-bold mb-4">üß™ Potions</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {POTIONS.map(potion => (
                                    <div key={potion.id} className={`p-4 rounded-xl bg-gradient-to-br ${potion.color} text-white`}>
                                        <div className="font-bold text-lg mb-2">{potion.name}</div>
                                        <div className="text-sm mb-3">
                                            <div>{potion.type === 'luck' ? 'üçÄ' : 'üí∞'} {potion.multiplier}x {potion.type === 'luck' ? 'Luck' : 'Coins'}</div>
                                            <div>‚è±Ô∏è {Math.floor(potion.duration / 1000)}s duration</div>
                                        </div>
                                        <button
                                            onClick={() => handleBuyPotion(potion)}
                                            disabled={stats.coins < potion.price}
                                            className={`w-full py-2 rounded-lg font-bold transition ${
                                                stats.coins >= potion.price
                                                    ? 'bg-white/20 hover:bg-white/30'
                                                    : 'bg-gray-800 cursor-not-allowed'
                                            }`}
                                        >
                                            Buy for üí∞ {potion.price.toLocaleString()}
                                        </button>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const SettingsModal = ({ stats, setStats, showSettings, setShowSettings }) => {
            if (!showSettings) return null;

            const toggleCutscene = (rarity) => {
                setStats(prev => ({
                    ...prev,
                    cutsceneSettings: {
                        ...prev.cutsceneSettings,
                        [rarity]: !prev.cutsceneSettings[rarity]
                    }
                }));
            };

            const resetProgress = () => {
                if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                    localStorage.removeItem('lebron-rng-stats-v5');
                    window.location.reload();
                }
            };

            return (
                <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" onClick={() => setShowSettings(false)}>
                    <div className="bg-gray-900 rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto border-2 border-blue-500" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-3xl font-bold">‚öôÔ∏è Settings</h2>
                            <button onClick={() => setShowSettings(false)} className="text-4xl hover:text-red-500 transition">&times;</button>
                        </div>

                        <div className="mb-8">
                            <h3 className="text-xl font-bold mb-4">üé¨ Cutscene Settings</h3>
                            <div className="space-y-3">
                                {[Rarity.LEGENDARY, Rarity.MYTHIC, Rarity.CELESTIAL, Rarity.DIVINE, Rarity.GOAT].map(rarity => (
                                    <div key={rarity} className="flex items-center justify-between p-4 bg-gray-800 rounded-lg">
                                        <span className={RARITY_CONFIG[rarity].color}>{rarity}</span>
                                        <label className="relative inline-flex items-center cursor-pointer">
                                            <input
                                                type="checkbox"
                                                checked={stats.cutsceneSettings?.[rarity] ?? true}
                                                onChange={() => toggleCutscene(rarity)}
                                                className="sr-only peer"
                                            />
                                            <div className="w-11 h-6 bg-gray-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="mb-8">
                            <h3 className="text-xl font-bold mb-4">üìä Statistics</h3>
                            <div className="bg-gray-800 p-4 rounded-lg space-y-2">
                                <div>Total Rolls: {stats.totalRolls.toLocaleString()}</div>
                                <div>Total Coins: üí∞ {stats.coins.toLocaleString()}</div>
                                <div>Collection: {stats.inventory.length} / {PLAYERS.length} LeBrons</div>
                                <div>Luck Level: {stats.luckUpgrades}</div>
                            </div>
                        </div>

                        <div>
                            <h3 className="text-xl font-bold mb-4 text-red-500">‚ö†Ô∏è Danger Zone</h3>
                            <button
                                onClick={resetProgress}
                                className="w-full py-3 bg-red-600 hover:bg-red-700 rounded-lg font-bold transition"
                            >
                                Reset All Progress
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const Cutscene = ({ player, onComplete }) => {
            if (!player) return null;

            return (
                <div className="fixed inset-0 bg-black z-50 flex items-center justify-center">
                    <div className="text-center fade-in">
                        <div className="text-6xl mb-8 glow-animate">‚≠ê</div>
                        <div className={`text-5xl font-bold mb-4 ${player.color}`}>{player.name}</div>
                        <div className={`text-3xl mb-8 ${RARITY_CONFIG[player.rarity].color}`}>{player.rarity}</div>
                        <img src={player.image} alt={player.name} className="w-64 h-64 mx-auto mb-8 rounded-2xl object-cover border-4 border-white shadow-2xl" />
                        <button
                            onClick={onComplete}
                            className="px-8 py-4 bg-white text-black rounded-lg font-bold text-xl hover:bg-gray-200 transition"
                        >
                            Continue
                        </button>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [stats, setStats] = useState(() => {
                const saved = localStorage.getItem('lebron-rng-stats-v5');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    if (!parsed.cutsceneSettings) {
                        parsed.cutsceneSettings = {
                            [Rarity.LEGENDARY]: true,
                            [Rarity.MYTHIC]: true,
                            [Rarity.CELESTIAL]: true,
                            [Rarity.DIVINE]: true,
                            [Rarity.GOAT]: true,
                        };
                    }
                    return parsed;
                }
                return {
                    coins: 0,
                    luckMultiplier: 1,
                    totalRolls: 0,
                    inventory: [],
                    equipped: [],
                    luckUpgrades: 0,
                    activePotions: { luck: 0, money: 0 },
                    cutsceneSettings: {
                        [Rarity.LEGENDARY]: true,
                        [Rarity.MYTHIC]: true,
                        [Rarity.CELESTIAL]: true,
                        [Rarity.DIVINE]: true,
                        [Rarity.GOAT]: true,
                    }
                };
            });

            const [lastRoll, setLastRoll] = useState(null);
            const [isRolling, setIsRolling] = useState(false);
            const [showInventory, setShowInventory] = useState(false);
            const [showShop, setShowShop] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [cutscenePlayer, setCutscenePlayer] = useState(null);
            const [showAllPlayers, setShowAllPlayers] = useState(false);

            useEffect(() => {
                localStorage.setItem('lebron-rng-stats-v5', JSON.stringify(stats));
            }, [stats]);

            useEffect(() => {
                const interval = setInterval(() => {
                    setStats(prev => {
                        const now = Date.now();
                        return {
                            ...prev,
                            activePotions: {
                                luck: prev.activePotions.luck > now ? prev.activePotions.luck : 0,
                                money: prev.activePotions.money > now ? prev.activePotions.money : 0
                            }
                        };
                    });
                }, 1000);
                return () => clearInterval(interval);
            }, []);

            const calculateTotalLuck = useCallback(() => {
                let base = stats.luckMultiplier;
                const equippedBonus = stats.equipped.reduce((sum, p) => sum + p.luckBonus, 0);
                const potionMultiplier = stats.activePotions.luck > Date.now() 
                    ? POTIONS.find(p => p.type === 'luck' && stats.activePotions.luck > 0)?.multiplier || 1
                    : 1;
                return (base + equippedBonus) * potionMultiplier;
            }, [stats]);

            const rollPlayer = useCallback(() => {
                if (isRolling) return;
                
                setIsRolling(true);
                setLastRoll(null);

                setTimeout(() => {
                    const totalLuck = calculateTotalLuck();
                    const rand = Math.random() * 1000000;
                    
                    let cumulativeChance = 0;
                    let selectedPlayer = PLAYERS[0];

                    for (const player of PLAYERS) {
                        const adjustedOdds = player.odds / totalLuck;
                        const chance = 1000000 / adjustedOdds;
                        cumulativeChance += chance;
                        
                        if (rand < cumulativeChance) {
                            selectedPlayer = player;
                            break;
                        }
                    }

                    const moneyMultiplier = stats.activePotions.money > Date.now()
                        ? POTIONS.find(p => p.type === 'money')?.multiplier || 1
                        : 1;

                    const coinReward = selectedPlayer.coinsBonus * moneyMultiplier;

                    setStats(prev => ({
                        ...prev,
                        coins: prev.coins + coinReward,
                        totalRolls: prev.totalRolls + 1,
                        inventory: prev.inventory.some(p => p.id === selectedPlayer.id)
                            ? prev.inventory
                            : [...prev.inventory, selectedPlayer]
                    }));

                    setLastRoll(selectedPlayer);
                    setIsRolling(false);

                    if (stats.cutsceneSettings?.[selectedPlayer.rarity] && 
                        [Rarity.LEGENDARY, Rarity.MYTHIC, Rarity.CELESTIAL, Rarity.DIVINE, Rarity.GOAT].includes(selectedPlayer.rarity)) {
                        setCutscenePlayer(selectedPlayer);
                    }
                }, 2000);
            }, [isRolling, calculateTotalLuck, stats]);

            const formatTime = (ms) => {
                if (ms <= 0) return '0s';
                const seconds = Math.ceil((ms - Date.now()) / 1000);
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return minutes > 0 ? `${minutes}m ${secs}s` : `${secs}s`;
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        <header className="text-center mb-8">
                            <h1 className="text-5xl font-bold mb-2 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 text-transparent bg-clip-text">
                                üèÄ LeBron RNG: King's Gacha
                            </h1>
                            <p className="text-gray-400">Collect every version of The King!</p>
                        </header>

                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                            <div className="bg-gray-800/50 p-4 rounded-xl border border-yellow-500/30">
                                <div className="text-sm text-gray-400">üí∞ Coins</div>
                                <div className="text-2xl font-bold">{stats.coins.toLocaleString()}</div>
                            </div>
                            <div className="bg-gray-800/50 p-4 rounded-xl border border-purple-500/30">
                                <div className="text-sm text-gray-400">üçÄ Total Luck</div>
                                <div className="text-2xl font-bold">{calculateTotalLuck().toFixed(1)}x</div>
                            </div>
                            <div className="bg-gray-800/50 p-4 rounded-xl border border-blue-500/30">
                                <div className="text-sm text-gray-400">üé≤ Rolls</div>
                                <div className="text-2xl font-bold">{stats.totalRolls.toLocaleString()}</div>
                            </div>
                            <div className="bg-gray-800/50 p-4 rounded-xl border border-green-500/30">
                                <div className="text-sm text-gray-400">üì¶ Collection</div>
                                <div className="text-2xl font-bold">{stats.inventory.length}/{PLAYERS.length}</div>
                            </div>
                        </div>

                        {(stats.activePotions.luck > Date.now() || stats.activePotions.money > Date.now()) && (
                            <div className="mb-6 p-4 bg-gradient-to-r from-purple-900/50 to-blue-900/50 rounded-xl border border-purple-500">
                                <div className="font-bold mb-2">üß™ Active Potions</div>
                                {stats.activePotions.luck > Date.now() && (
                                    <div className="text-sm">üçÄ Luck Boost: {formatTime(stats.activePotions.luck)}</div>
                                )}
                                {stats.activePotions.money > Date.now() && (
                                    <div className="text-sm">üí∞ Money Boost: {formatTime(stats.activePotions.money)}</div>
                                )}
                            </div>
                        )}

                        <EquippedDisplay equipped={stats.equipped} />
                        <RollDisplay lastRoll={lastRoll} isRolling={isRolling} />

                        <div className="flex flex-wrap gap-4 justify-center mb-8">
                            <button
                                onClick={rollPlayer}
                                disabled={isRolling}
                                className={`px-8 py-4 rounded-xl font-bold text-xl transition transform hover:scale-105 ${
                                    isRolling 
                                        ? 'bg-gray-600 cursor-not-allowed' 
                                        : 'bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 shadow-lg shadow-orange-500/50'
                                }`}
                            >
                                {isRolling ? 'üé≤ Rolling...' : 'üé≤ ROLL'}
                            </button>
                            <button onClick={() => setShowInventory(true)} className="px-6 py-4 bg-blue-600 hover:bg-blue-700 rounded-xl font-bold transition">
                                üì¶ Inventory
                            </button>
                            <button onClick={() => setShowShop(true)} className="px-6 py-4 bg-green-600 hover:bg-green-700 rounded-xl font-bold transition">
                                üõí Shop
                            </button>
                            <button onClick={() => setShowSettings(true)} className="px-6 py-4 bg-purple-600 hover:bg-purple-700 rounded-xl font-bold transition">
                                ‚öôÔ∏è Settings
                            </button>
                        </div>

                        <div className="text-center">
                            <button
                                onClick={() => setShowAllPlayers(!showAllPlayers)}
                                className="px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg font-bold transition mb-4"
                            >
                                {showAllPlayers ? 'üôà Hide' : 'üëÅÔ∏è Show'} All LeBrons
                            </button>
                            
                            {showAllPlayers && (
                                <div className="bg-gray-800/50 p-6 rounded-xl border border-gray-700 slide-up">
                                    <h3 className="text-2xl font-bold mb-4">All Available LeBrons</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                                        {PLAYERS.map(player => (
                                            <div key={player.id} className={`p-4 rounded-lg ${RARITY_CONFIG[player.rarity].bg} border ${RARITY_CONFIG[player.rarity].color}`}>
                                                <div className="flex items-center gap-3">
                                                    <img src={player.image} alt={player.name} className="w-16 h-16 rounded-lg object-cover" />
                                                    <div className="flex-1">
                                                        <div className={`font-bold ${player.color}`}>{player.name}</div>
                                                        <div className={`text-sm ${RARITY_CONFIG[player.rarity].color}`}>{player.rarity}</div>
                                                        <div className="text-xs text-gray-400">1 in {player.odds.toLocaleString()}</div>
                                                    </div>
                                                    {stats.inventory.some(p => p.id === player.id) && (
                                                        <div className="text-2xl">‚úÖ</div>
                                                    )}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    <InventoryModal stats={stats} setStats={setStats} showInventory={showInventory} setShowInventory={setShowInventory} />
                    <ShopModal stats={stats} setStats={setStats} showShop={showShop} setShowShop={setShowShop} />
                    <SettingsModal stats={stats} setStats={setStats} showSettings={showSettings} setShowSettings={setShowSettings} />
                    {cutscenePlayer && <Cutscene player={cutscenePlayer} onComplete={() => setCutscenePlayer(null)} />}
                </div>
            );
        };

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
